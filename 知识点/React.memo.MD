# React.memo

> é’ˆå¯¹å‡½æ•°å¼ç»„ä»¶æ€§èƒ½ä¼˜åŒ–

```js
// å½“çˆ¶ç»„ä»¶æ¸²æŸ“æ—¶ï¼Œå­ç»„ä»¶ä¹Ÿä¼šæ¸²æŸ“ï¼Œå¦‚æœå­ç»„ä»¶çŠ¶æ€æ²¡æ”¹å˜ï¼ˆpropsä¸å˜æ—¶ï¼‰ï¼Œæ­¤æ—¶æ²¡å¿…è¦é¢å¤–çš„æ¸²æŸ“ï¼Œå¯ä»¥å°†å­ç»„ä»¶ç¼“å­˜
const MyComponent = React.memo(function MyComponent(props) {
  /* ä½¿ç”¨ props æ¸²æŸ“ */
});
```

`ä¸¾ä¸ªğŸŒ°`
```js
// App
function App() {
  const [title, setTitle] = useState("è¿™æ˜¯ä¸€ä¸ª title")
  return (
    <div className="App">
      <h1>{ title }</h1>
      <button onClick={() => setTitle("title å·²ç»æ”¹å˜")}>æ”¹åå­—</button>
      {/* çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå­ç»„ä»¶æ²¡å¿…è¦é‡æ–°æ¸²æŸ“ */}
      <Child name="æ¡ƒæ¡ƒ"></Child>
    </div>
  );
}
```

```jsx
import React from "react";

function Child(props) {
  return <h1>{props.name}</h1>
}
// React.memoå…¶å®æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œä¼ é€’ä¸€ä¸ªç»„ä»¶è¿›å»ï¼Œè¿”å›ä¸€ä¸ªå¯ä»¥è®°å¿†çš„ç»„ä»¶
export default React.memo(Child)
```

+ é»˜è®¤æƒ…å†µä¸‹å…¶åªä¼šå¯¹å¤æ‚å¯¹è±¡åšæµ…å±‚å¯¹æ¯”

```jsx
class App extends Component {
  constructor(props) {
    super(props);
    this.state = {
      title: 'æ ‡é¢˜',
      obj: {
        name: 'zhangsan'
      }
    }
    this.changeBtn = this.changeBtn.bind(this);
  }
  render() {
    console.log('render')
    return (
      <div>
        <h1>{this.state.title}</h1>
        <button onClick={ this.changeBtn }>æ”¹å˜æ ‡é¢˜</button>
        <ChildMemo data={this.state.obj} />
      </div>
    );
  }

  changeBtn() {
    this.setState({
      title: 'æ ‡é¢˜æ”¹å˜äº†',
      obj: { // æ³¨æ„ã€‚ä¼ é€’ç»™å­ç»„ä»¶çš„propsæ”¹å˜äº†
        name: 'æå››'
      }
    })
  }
}
```

```jsx
// ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œè‡ªå®šä¹‰æ¯”è¾ƒåˆ¤æ–­æ˜¯å¦éœ€è¦æ¸²æŸ“
function Child(props) {
  console.log('å­ç»„ä»¶æ¸²æŸ“äº†');
  return <div>{ props.data.name }</div>
}

function areEqual(prevProps, nextProps) {
  return prevProps.data.name === nextProps.data.name;
}
// é»˜è®¤æƒ…å†µä¸‹å…¶åªä¼šå¯¹å¤æ‚å¯¹è±¡åšæµ…å±‚å¯¹æ¯”,ç¬¬äºŒä¸ªå‚æ•°è‡ªå®šä¹‰æ¯”è¾ƒå‰åä¸¤ä¸ªpropsçš„å€¼ï¼Œå¦‚æœè¿”å›false,åˆ™ä¸æ¸²æŸ“
const ChildMemo = React.memo(Child, areEqual);
```